(window.webpackJsonp=window.webpackJsonp||[]).push([[30,4,6],{331:function(t,e,n){"use strict";n.r(e);var r={props:{isEdit:{type:Boolean,default:function(){return!1}},height:{type:String,default:function(){return"min-h-[40px]"}},py:{type:String,default:function(){return"py-3"}},px:{type:String,default:function(){return"px-3"}},my:{type:String,default:function(){return"mb-2.5"}},mx:{type:String,default:function(){return""}},customCss:{type:String,default:function(){return""}}},name:"MemberGlobalCard"},o=n(33),component=Object(o.a)(r,(function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"w-full bg-white rounded-md relative",class:[t.height,t.px,t.py,t.mx,t.my,t.customCss,{"shadow-[0px_0px_4px_1px_#F1FF99]":t.isEdit,"shadow-[0px_2px_2px_rgba(0,0,0,0.25)]":!t.isEdit}]},[t._t("default")],2)])}),[],!1,null,null,null);e.default=component.exports},332:function(t,e,n){"use strict";n.r(e);var r={computed:{isLoading:function(){return this.$store.state.itemLoading.isLoading}}},o=n(33),component=Object(o.a)(r,(function(){var t=this,e=t._self._c;return e("section",[e("transition",{attrs:{name:"fade"}},[t.isLoading?e("div",{staticClass:"w-full min-h-[100px] flex items-center justify-center pointer-events-none z-50"},[e("div",{staticClass:"border-[5px] border-[#e2e2e2] border-t-[5px] border-t-[#232D4E] rounded-full w-10 h-10 animate-spin-slow"})]):t._e()])],1)}),[],!1,null,null,null);e.default=component.exports},369:function(t,e,n){"use strict";n.r(e);n(21),n(59),n(239);var r=n(79),o={name:"setting-edit",data:function(){return{designers:[],favoriteInfo:{id:"",name:"",designer:""},defaultMerchant:{},merchants:[],merchantsIsNull:!0,searchInput:"",isShowDefault:!0,searchingDesigners:!1,isChanging:!1}},methods:{searchMerchants:function(){var t=this,e=this.searchInput;setTimeout((function(){if(e===t.searchInput){Object(r.c)(),t.merchants=[],t.merchantsIsNull=!1,t.isShowDefault=!1,t.$store.dispatch("itemLoading/isLoading",!0);var input=t.searchInput.trim();if(!input)return t.isShowDefault=!0,void t.$store.dispatch("itemLoading/isLoading",!1);t.api.getAllMerchants(input).then((function(e){0===e.data.getAllMerchants.length&&(t.merchantsIsNull=!0),t.merchants=e.data.getAllMerchants,t.$store.dispatch("itemLoading/isLoading",!1)})).catch((function(t){console.log(t)}))}}),500)},searchDesigner:function(t){var e=this;this.favoriteInfo.id!==t&&(Object(r.c)(),this.searchingDesigners=!0,this.designers=[],this.api.customerGetMerchantDesigners(t).then((function(t){e.designers=t.data.customerGetMerchantDesigners,e.searchingDesigners=!1})).catch((function(t){console.log(t)})))},selectStore:function(t){this.favoriteInfo.id!==t.id&&(this.favoriteInfo.designer="",this.favoriteInfo.id=t.id,this.favoriteInfo.name=t.name)},selectDesigner:function(t){this.favoriteInfo.designer=t},isSelectedStore:function(t){return this.favoriteInfo.id===t},saveFavorite:function(){var t=this;this.isChanging=!0;var e=this.favoriteInfo.id==this.defaultMerchant.id;!this.favoriteInfo.designer&&e&&this.customerGetCurrentMerchantSetting(),this.favoriteInfo.designer||e||this.api.updateCustomerCuttentMerchant(this.favoriteInfo.id).then((function(e){if(e.data.hasError)throw e.errors;t.customerGetCurrentMerchantSetting()})).catch((function(t){console.log(t)})),this.favoriteInfo.designer&&!e&&this.api.updateCustomerCuttentMerchant(this.favoriteInfo.id).then((function(e){if(e.data.hasError)throw e.errors;t.api.updateCustomerPreferDesigner(t.favoriteInfo.designer,t.favoriteInfo.id).then((function(){t.customerGetCurrentMerchantSetting()})).catch((function(t){console.log(t)}))})).catch((function(t){console.log(t)})),this.favoriteInfo.designer&&e&&this.api.updateCustomerPreferDesigner(this.favoriteInfo.designer,this.favoriteInfo.id).then((function(){t.customerGetCurrentMerchantSetting()})).catch((function(t){console.log(t)}))},customerGetCurrentMerchantSetting:function(){var t=this,e=JSON.parse(localStorage.getItem("isNewCustomerAndNomerchant"));window.localStorage.clear(),this.api.customerGetCurrentMerchantSetting().then((function(n){if(!n.data.hasError){var r=n.data.customerGetCurrentMerchantSetting;localStorage.setItem("allMerchants",JSON.stringify(r.consumedMerchants)),localStorage.setItem("merchant",JSON.stringify(r.currentMerchant)),localStorage.setItem("preferDesigner",JSON.stringify(r.preferDesigner)),t.isChanging=!1,t.$swal.fire({icon:"success",title:'<h3 class="text-2xl">已儲存偏好設定</h3>',background:"#fff",iconColor:"#FEB401",timer:1500,showConfirmButton:!1}).then((function(){e?t.$router.push("/member/appointment"):t.$router.push("/member/setting")}))}})).catch((function(t){console.log(t)}))}},mounted:function(){var t=JSON.parse(window.localStorage.getItem("merchant"))||{};null!=t&&t.id&&this.searchDesigner(null==t?void 0:t.id),this.defaultMerchant=t,this.selectStore(this.defaultMerchant)}},c=n(33),component=Object(c.a)(o,(function(){var t=this,e=t._self._c;return e("section",{attrs:{id:"firstPos"}},[e("h4",{pre:!0,attrs:{class:"text-lg mb-3"}},[t._v("選擇登入店家")]),t._v(" "),e("div",{staticClass:"w-full bg-white border border-[#aeaeae] rounded-md overflow-hidden relative"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchInput,expression:"searchInput"}],staticClass:"appearance-none bg-white w-full rounded-md py-1 px-3 text-[#666] focus:border-0 focus:outline-none",attrs:{type:"text",placeholder:"搜尋關鍵字"},domProps:{value:t.searchInput},on:{input:[function(e){e.target.composing||(t.searchInput=e.target.value)},function(e){return t.searchMerchants()}]}}),t._v(" "),e("fa",{staticClass:"absolute right-5 top-1/2 -translate-y-1/2",attrs:{icon:"fa-regular fa-magnifying-glass"}})],1),t._v(" "),t.isShowDefault&&t.defaultMerchant.id?e("div",{staticClass:"mt-4"},[e("MemberGlobalCard",{attrs:{py:"py-4",px:"px-4","data-aos":"fade-up","data-aos-delay":"100","data-aos-once":"true","data-aos-duration":"300","data-aos-anchor":"#firstPos"}},[e("div",{staticClass:"grid grid-cols-12 items-center w-full",on:{click:function(e){t.searchDesigner(t.defaultMerchant.id),t.selectStore(t.defaultMerchant)}}},[e("div",{staticClass:"col-span-5 relative"},[e("div",{staticClass:"w-5 h-5 rounded-full border-2 border-[#4ADE80] flex justify-center items-center duration-300 scale-0",class:{"scale-100":t.isSelectedStore(t.defaultMerchant.id)}},[e("fa",{staticClass:"text-[#4ADE80] text-xs",attrs:{icon:"fa-solid fa-check"}})],1),t._v(" "),e("h4",{staticClass:"text-lg line-clamp-1 duration-300 absolute left-0 top-1/2 -translate-y-1/2",class:{"left-8":t.isSelectedStore(t.defaultMerchant.id)}},[t._v("\n            "+t._s(t.defaultMerchant.name)+"\n          ")])]),t._v(" "),e("div",{staticClass:"col-span-7"},[e("p",{staticClass:"text-sm line-clamp-1"},[t._v(t._s(t.defaultMerchant.address))])])])])],1):t._e(),t._v(" "),t.merchants.length>0&&!t.merchantsIsNull?e("div",{staticClass:"w-full mt-4"},t._l(t.merchants,(function(n,r){return e("MemberGlobalCard",{key:n.id,attrs:{py:"py-4",px:"px-4","data-aos":"fade-up","data-aos-delay":100*r,"data-aos-once":"true","data-aos-duration":"300","data-aos-anchor":"#firstPos"}},[e("div",{staticClass:"grid grid-cols-12 items-center w-full",on:{click:function(e){t.searchDesigner(n.id),t.selectStore(n)}}},[e("div",{staticClass:"col-span-5 relative"},[e("div",{staticClass:"w-5 h-5 rounded-full border-2 border-[#4ADE80] flex justify-center items-center duration-300 scale-0",class:{"scale-100":t.isSelectedStore(n.id)}},[e("fa",{staticClass:"text-[#4ADE80] text-xs",attrs:{icon:"fa-solid fa-check"}})],1),t._v(" "),e("h4",{staticClass:"text-lg line-clamp-1 duration-300 absolute left-0 top-1/2 -translate-y-1/2",class:{"left-8":t.isSelectedStore(n.id)}},[t._v("\n            "+t._s(n.name)+"\n          ")])]),t._v(" "),e("div",{staticClass:"col-span-7"},[e("p",{staticClass:"text-sm line-clamp-1"},[t._v(t._s(n.address))])])])])})),1):t._e(),t._v(" "),t.merchantsIsNull&&!t.isShowDefault?e("div",{staticClass:"mt-6 text-center text-sm text-slate-500"},[t._v("\n    查無門市\n  ")]):t._e(),t._v(" "),e("ItemLoading"),t._v(" "),e("h4",{pre:!0,attrs:{"data-aos":"fade-up","data-aos-delay":"100","data-aos-duration":"300","data-aos-once":"true","data-aos-anchor":"#firstPos",class:"text-lg mt-12"}},[t._v("\n    選擇喜好設計師\n  ")]),t._v(" "),e("ul",{staticClass:"pl-7 pr-4 gap-4 mt-4 bg-white rounded-lg border border-[#aeaeae] shadow-[0px_2px_2px_rgba(0,0,0,0.25)] min-h-[96px]",class:{"pt-4":0===t.designers.length},attrs:{"data-aos":"fade-up","data-aos-delay":"100","data-aos-duration":"300","data-aos-once":"true","data-aos-anchor":"#firstPos"}},[t.searchingDesigners?e("div",{staticClass:"min-h-[150px] w-full flex items-center justify-center"},[e("div",{staticClass:"border-4 border-t-[#232D4E] rounded-full w-10 h-10 animate-spin-slow"})]):t._e(),t._v(" "),0!==t.designers.length||t.searchingDesigners?t._e():e("span",{staticClass:"text-[#aeaeae] text-sm"},[t._v("查無資料")]),t._v(" "),t._l(t.designers,(function(n,r){return e("li",{key:n.id,staticClass:"my-4",attrs:{"data-aos":"fade","data-aos-delay":100+50*r,"data-aos-duration":"300","data-aos-once":"true","data-aos-anchor":"#firstPos"},on:{click:function(e){return t.selectDesigner(n.id)}}},[e("div",{staticClass:"flex items-center justify-between"},[e("div",{staticClass:"flex items-center gap-4"},[e("img",{staticClass:"w-12 h-12 rounded-full object-cover object-center select-none pointer-events-none",attrs:{src:n.avatar,alt:n.name}}),t._v(" "),e("h4",{staticClass:"text-sm line-clamp-1"},[t._v("\n            "+t._s(n.name)+"\n            "),n.nickName?e("span",[t._v("("+t._s(n.nickName)+")")]):t._e()])]),t._v(" "),e("div",{staticClass:"flex items-center gap-4 duration-300",class:{"scale-100":t.favoriteInfo.designer===n.id,"scale-0":t.favoriteInfo.designer!==n.id}},[e("p",{staticClass:"text-[#4ADE80] text-sm"},[t._v("已選")]),t._v(" "),e("div",{staticClass:"w-8 h-8 border-2 border-[#4ADE80] flex justify-center items-center rounded-full"},[e("fa",{staticClass:"text-sm text-[#4ADE80]",attrs:{icon:"fa-solid fa-check"}})],1)])])])}))],2),t._v(" "),e("button",{staticClass:"fixed bottom-24 left-[5%] w-[90%] py-2.5 shadow-md rounded-md duration-300 mt-5 flex items-center justify-center gap-2 z-10",class:{"bg-[#bebebe] pointer-events-none":t.isChanging||!t.favoriteInfo.id,"bg-[#232D4E]":!t.isChanging},on:{click:t.saveFavorite}},[t.isChanging?e("fa",{staticClass:"animate-spin text-white",attrs:{icon:"fa-solid fa-spinner"}}):t._e(),t._v(" "),e("p",{staticClass:"text-lg text-white"},[t._v("儲存設定")])],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{MemberGlobalCard:n(331).default,ItemLoading:n(332).default})}}]);
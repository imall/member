(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{343:function(e,t,n){var r=n(2),o=n(236).values;r({target:"Object",stat:!0},{values:function(e){return o(e)}})},344:function(e,t,n){"use strict";var r=n(2),o=n(3),c=n(63),l=n(36),d=n(52),f=n(238),m=n(16),h=n(4),v=n(237),x=n(154),C=n(345),_=n(346),k=n(101),I=n(347),w=[],S=o(w.sort),$=o(w.push),D=h((function(){w.sort(void 0)})),y=h((function(){w.sort(null)})),F=x("sort"),B=!h((function(){if(k)return k<70;if(!(C&&C>3)){if(_)return!0;if(I)return I<603;var code,e,t,n,r="";for(code=65;code<76;code++){switch(e=String.fromCharCode(code),code){case 66:case 69:case 70:case 72:t=3;break;case 68:case 71:t=4;break;default:t=2}for(n=0;n<47;n++)w.push({k:e+n,v:t})}for(w.sort((function(a,b){return b.v-a.v})),n=0;n<w.length;n++)e=w[n].k.charAt(0),r.charAt(r.length-1)!==e&&(r+=e);return"DGBEFHACIJK"!==r}}));r({target:"Array",proto:!0,forced:D||!y||!F||!B},{sort:function(e){void 0!==e&&c(e);var t=l(this);if(B)return void 0===e?S(t):S(t,e);var n,r,o=[],h=d(t);for(r=0;r<h;r++)r in t&&$(o,t[r]);for(v(o,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:m(t)>m(n)?1:-1}}(e)),n=d(o),r=0;r<n;)t[r]=o[r++];for(;r<h;)f(t,r++);return t}})},345:function(e,t,n){var r=n(83).match(/firefox\/(\d+)/i);e.exports=!!r&&+r[1]},346:function(e,t,n){var r=n(83);e.exports=/MSIE|Trident/.test(r)},347:function(e,t,n){var r=n(83).match(/AppleWebKit\/(\d+)\./);e.exports=!!r&&+r[1]},358:function(e,t,n){"use strict";n.r(t);n(21),n(62),n(50),n(11);var r=n(13),o=(n(60),n(25),n(35),n(235),n(61),n(82),n(343),n(344),{name:"appointment-selectService",data:function(){return{serviceItem:[],selectTab:"all",selectTabId:"",selectService:[],remarkForCustomer:"",isLoading:!1,customerReference:[],selectReference:"",checkHasServiceItem:!1}},computed:{designerId:function(){return this.$store.state.appointmentData.designerId},selectDesigner:function(){return this.$store.state.appointmentData.designerName},selectDesignerNickName:function(){return this.$store.state.appointmentData.designerNickName},selectTime:function(){return this.$store.state.appointmentData.time},switchTabStyle:function(){if("all"===this.selectTab)return"left: 0px; width: 68px;";var e=this.selectTab,t=document.querySelector(".service__tab-".concat(e)).clientWidth,n=document.querySelector(".service__tab-".concat(e)).offsetLeft;return"left: ".concat(n,"px; width: ").concat(t,"px;")},filterServiceList:function(){var e=this;if(""===this.selectTabId){var t=[];return this.serviceItem.forEach((function(e){e.bookingItem.forEach((function(e){return t.push(e)}))})),t}return this.serviceItem.find((function(t){return t.id===e.selectTabId})).bookingItem},isGlobalLoading:function(){return this.$store.state.loading.isLoading}},methods:{selectServiceFn:function(e){this.selectService.map((function(e){return e.id})).includes(e.id)?this.selectService=this.selectService.filter((function(t){return t.id!==e.id})):this.selectService.push(e)},isSelectedService:function(e){return this.selectService.map((function(e){return e.id})).includes(e)},cancelService:function(e){this.selectService=this.selectService.filter((function(t){return t.id!==e.id}))},checkAppointmentData:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return data=Object.values(e.$store.state.appointmentData),t.next=3,data.every((function(e){return e}));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},handleBooking:function(){var e=this;if(!this.isLoading){var t="";this.selectService.length>0&&this.selectService.forEach((function(n,r){r!==e.selectService.length-1?t+="".concat(n.name,"、"):t+="".concat(n.name," ")})),this.isLoading=!0;var n=this.$store.state.indexCache.userInfo.cellphone,r=this.$store.state.indexCache.userInfo.name;if(n&&r){var input={designerId:this.$store.state.appointmentData.designerId,dateTime:this.$store.state.appointmentData.timestamp,cellphone:n,merchantId:this.$store.state.appointmentData.merchantId,name:r,reference:this.customerReference,remarkForCustomer:t+=this.remarkForCustomer};this.api.bookingV2(input).then((function(t){t.hasOwnProperty("errors")?e.$router.push("/member/appointment/selectDate"):(window.localStorage.setItem("bookingData",JSON.stringify(t.data.bookingV2)),e.$swal.fire({icon:"success",title:'<h3 class="text-2xl">預約成功</h3>',background:"#fff",iconColor:"#FEB401",timer:1500,showConfirmButton:!1}).then((function(){e.isLoading=!1,e.$router.push("/member/appointment/check")})))})).catch((function(e){console.log(e)}))}else this.api.getCustomerPersonalData("name cellphone").then((function(o){e.$store.dispatch("indexCache/handleSetUserInfo",o.data.getCustomerPersonalData),n=e.$store.state.indexCache.userInfo.cellphone,r=e.$store.state.indexCache.userInfo.name;var input={designerId:e.$store.state.appointmentData.designerId,dateTime:e.$store.state.appointmentData.timestamp,cellphone:e.$store.state.indexCache.userInfo.cellphone,merchantId:e.$store.state.appointmentData.merchantId,name:e.$store.state.indexCache.userInfo.name,reference:e.selectReference,remarkForCustomer:t+=e.remarkForCustomer};e.api.bookingV2(input).then((function(t){t.hasOwnProperty("errors")?e.$router.push("/member/appointment/selectDate"):(window.localStorage.setItem("bookingData",JSON.stringify(t.data.bookingV2)),console.log(t.data),console.log(t.data.bookingV2),e.$swal.fire({icon:"success",title:'<h3 class="text-2xl">預約成功</h3>',background:"#fff",iconColor:"#FEB401",timer:1500,showConfirmButton:!1}).then((function(){e.isLoading=!1,e.$router.push("/member/appointment/check")})))})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}},handleNonDesignationBooking:function(){var e=this;if(!this.isLoading){this.isLoading=!0;var t=this.$store.state.indexCache.userInfo.cellphone,n=this.$store.state.indexCache.userInfo.name;if(t&&n){var input={bookingDate:this.$store.state.appointmentData.timestamp,cellphone:this.$store.state.indexCache.userInfo.cellphone,customerName:this.$store.state.indexCache.userInfo.name,storeId:this.$store.state.appointmentData.merchantId,remarkForCustomer:this.remarkForCustomer};this.api.nonDesignationBooking(input).then((function(t){window.localStorage.setItem("bookingData",JSON.stringify(t.data.nonDesignationBooking)),e.$swal.fire({icon:"success",title:'<h3 class="text-2xl">預約成功</h3>',background:"#fff",iconColor:"#FEB401",timer:1500,showConfirmButton:!1}).then((function(){e.isLoading=!1,e.$router.push("/member/appointment/check")}))})).catch((function(e){console.log(e)}))}else this.api.getCustomerPersonalData("name cellphone").then((function(r){e.$store.dispatch("indexCache/handleSetUserInfo",r.data.getCustomerPersonalData),t=e.$store.state.indexCache.userInfo.cellphone,n=e.$store.state.indexCache.userInfo.name;var input={bookingDate:e.$store.state.appointmentData.timestamp,cellphone:e.$store.state.indexCache.userInfo.cellphone,customerName:e.$store.state.indexCache.userInfo.name,storeId:e.$store.state.appointmentData.merchantId,remarkForCustomer:e.remarkForCustomer};e.api.nonDesignationBooking(input).then((function(t){t.data.hasErro||(window.localStorage.setItem("bookingData",JSON.stringify(t.data.nonDesignationBooking)),e.$swal.fire({icon:"success",title:'<h3 class="text-2xl">預約成功</h3>',background:"#fff",iconColor:"#FEB401",timer:1500,showConfirmButton:!1}).then((function(){e.isLoading=!1,e.$router.push("/member/appointment/check")})))})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}},getBookingItemCategoryForCustomer:function(){var e=this,input={storeId:this.$store.state.appointmentData.merchantId,designerId:this.$store.state.appointmentData.designerId};this.api.getBookingItemCategoryForCustomer(input).then((function(t){if(!t.data.hasError){t.data.getBookingItemCategoryForCustomer=t.data.getBookingItemCategoryForCustomer.sort((function(a,b){return a.sort-b.sort})),e.serviceItem=t.data.getBookingItemCategoryForCustomer;var n=0;e.serviceItem.forEach((function(e){e.bookingItem.sort((function(a,b){return a.sort-b.sort})),0!==(null==e?void 0:e.bookingItem.length)&&n++})),n&&(e.checkHasServiceItem=!0)}e.$store.dispatch("loading/isLoading",!1)})).catch((function(e){console.log(e)}))},getCustomerReference:function(){var e=this;this.api.getCustomerReference().then((function(t){t.data.hasError||(e.customerReference=t.data.getCustomerReference),1===e.$store.state.appointmentData.designerId&&e.$store.dispatch("loading/isLoading",!1)})).catch((function(e){console.log(e)}))}},mounted:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.checkAppointmentData();case 2:t.sent?(e.$store.dispatch("loading/isLoading",!0),1!==e.$store.state.appointmentData.designerId&&e.getBookingItemCategoryForCustomer(),e.getCustomerReference()):e.$router.push("/member/appointment");case 4:case"end":return t.stop()}}),t)})))()}}),c=n(33),component=Object(c.a)(o,(function(){var e=this,t=e._self._c;return e.isGlobalLoading?e._e():t("section",{attrs:{id:"firstPos"}},[t("div",{staticClass:"w-full p-4 flex gap-4 border border-[#aeaeae] bg-white rounded-lg mt-3"},[t("div",{staticClass:"w-6 h-6 flex justify-center items-center border-2 border-[#4ADE80] rounded-full"},[t("fa",{staticClass:"text-[#4ADE80]",attrs:{icon:"fa-solid fa-check"}})],1),e._v(" "),t("div",{staticClass:"flex flex-col gap-2"},[t("p",{staticClass:"text-sm line-clamp-1"},[e._v("\n        已選設計師："+e._s(e.selectDesigner)+"\n        "),e.selectDesignerNickName&&1!==e.selectDesignerNickName?t("span",[e._v("("+e._s(e.selectDesignerNickName)+")")]):e._e()]),e._v(" "),t("p",{staticClass:"text-sm"},[e._v("已選時段 : "+e._s(e.selectTime))])])]),e._v(" "),e.checkHasServiceItem?t("h4",{staticClass:"text-[#666] font-bold mt-4 mb-2"},[e._v("\n    選擇服務項目\n  ")]):e._e(),e._v(" "),e.checkHasServiceItem?t("p",{staticClass:"text-xs text-[#aeaeae] mb-2.5"},[e._v("\n    價目僅供參考，實際價錢以設計師現場報價為準\n  ")]):e._e(),e._v(" "),e.checkHasServiceItem?t("div",{staticClass:"w-full px-2.5 pb-5 rounded-lg shadow-[0px_2px_2px_rgba(0,0,0,0.25)] bg-white border border-[#aeaeae]"},[t("ul",{staticClass:"flex relative overflow-x-auto overflow-y-hidden"},[t("li",{staticClass:"text-center text-lg flex-none border-b border-b-black service__tab-all"},[t("button",{staticClass:"w-full h-full px-4 pb-4 pt-5",attrs:{type:"button","data-mdb-ripple":"true","data-mdb-ripple-color":"#3c4d86"},on:{click:function(t){e.selectTab="all",e.selectTabId=""}}},[e._v("\n          全部\n        ")])]),e._v(" "),e._l(e.serviceItem,(function(n,r){return t("li",{key:n.id,staticClass:"text-center text-lg flex-none border-b border-b-black",class:["service__tab-".concat(r+1)]},[t("button",{staticClass:"w-full h-full px-4 pb-4 pt-5",attrs:{type:"button","data-mdb-ripple":"true","data-mdb-ripple-color":"#3c4d86"},on:{click:function(t){e.selectTab=r+1,e.selectTabId=n.id}}},[e._v("\n          "+e._s(n.name)+"\n        ")])])})),e._v(" "),t("div",{staticClass:"absolute bottom-[-1px] left-0 h-1 bg-black duration-300",style:e.switchTabStyle})],2),e._v(" "),e.filterServiceList.length>0?t("div",[e._m(0),e._v(" "),t("transition-group",{attrs:{tag:"ul",name:"fade"}},e._l(e.filterServiceList,(function(n){return t("li",{key:n.id,staticClass:"px-2 py-3 border-b border-b-[#aeaeae]",on:{click:function(t){return e.selectServiceFn(n)}}},[t("div",{staticClass:"flex justify-between"},[t("div",{staticClass:"col-span-10 relative"},[t("fa",{staticClass:"absolute left-0 top-1/2 -translate-y-1/2 duration-300 scale-0",class:{"scale-100":!e.isSelectedService(n.id)},attrs:{icon:"fa-regular fa-circle-plus"}}),e._v(" "),t("fa",{staticClass:"text-[#FEB401] absolute left-0 top-1/2 -translate-y-1/2 duration-300 scale-0",class:{"scale-100":e.isSelectedService(n.id)},attrs:{icon:"fa-regular fa-circle-minus"}}),e._v(" "),t("p",{staticClass:"text-sm duration-300 translate-x-6 line-clamp-1",class:{"text-[#FEB401]":e.isSelectedService(n.id)}},[e._v("\n                "+e._s(n.name)+"\n              ")])],1),e._v(" "),t("div",{staticClass:"col-span-2"},[t("p",{staticClass:"text-sm duration-300",class:{"text-[#FEB401]":e.isSelectedService(n.id)}},[e._v("\n                $"+e._s(n.lowestPrice)+"up\n              ")])])])])})),0)],1):t("p",{staticClass:"text-center text-stone-500 text-sm mt-5"},[e._v("\n      該類別暫無服務項目\n    ")])]):e._e(),e._v(" "),t("transition",{attrs:{name:"fade"}},[e.selectService.length>0?t("div",[t("h4",{pre:!0,attrs:{class:"text-[#666] font-bold mt-4 mb-3"}},[e._v("已選項目 :")]),e._v(" "),t("transition-group",{staticClass:"flex flex-wrap items-center gap-5 mb-10",attrs:{tag:"ul",name:"fade"}},e._l(e.selectService,(function(n){return t("li",{key:n.id,staticClass:"bg-[#FEB401] py-2 px-3 text-sm text-white rounded-xl relative"},[t("div",{staticClass:"absolute -right-2 -top-2 w-4 h-4 rounded-full bg-[#aeaeae] flex justify-center items-center",on:{click:function(t){return e.cancelService(n)}}},[t("fa",{staticClass:"text-white text-sm",attrs:{icon:"fa-solid fa-xmark"}})],1),e._v("\n          "+e._s(n.name)+"\n        ")])})),0)],1):e._e()]),e._v(" "),t("h4",{pre:!0,attrs:{class:"text-[#666] font-bold mt-4 mb-2"}},[e._v("備註")]),e._v(" "),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.remarkForCustomer,expression:"remarkForCustomer"}],staticClass:"w-full p-3 rounded-md shadow-[0px_2px_2px_rgba(0,0,0,0.25)] border border-[#aeaeae]",attrs:{rows:"4",placeholder:"其他需求 ? 留言給設計師吧 !"},domProps:{value:e.remarkForCustomer},on:{input:function(t){t.target.composing||(e.remarkForCustomer=t.target.value)}}}),e._v(" "),t("h4",{pre:!0,attrs:{class:"text-[#666] font-bold mt-4 mb-2"}},[e._v("\n    您是從哪裡得知我們的？\n  ")]),e._v(" "),t("div",{staticClass:"w-full relative"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectReference,expression:"selectReference"}],staticClass:"appearance-none w-full py-2.5 px-4 rounded-lg shadow-[0px_2px_2px_rgba(0,0,0,0.25)] bg-white",on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.selectReference=t.target.multiple?n:n[0]}}},[t("option",{attrs:{value:"",selected:"",disabled:""}},[e._v("請選擇")]),e._v(" "),e._l(e.customerReference,(function(n){return t("option",{key:n,domProps:{value:n}},[e._v("\n        "+e._s(n)+"\n      ")])}))],2),e._v(" "),t("fa",{staticClass:"absolute right-5 top-1/2 -translate-y-1/2",attrs:{icon:"fa-regular fa-angle-down"}})],1),e._v(" "),1!==e.designerId?t("button",{staticClass:"fixed bottom-24 left-[5%] w-[90%] py-2.5 text-white text-lg rounded-md mt-10 duration-300 z-0",class:{"bg-[#232D4E]":!e.isLoading,"bg-[#bebebe] pointer-events-none":e.isLoading},on:{click:function(t){return e.handleBooking()}}},[e.isLoading?t("fa",{staticClass:"animate-spin",attrs:{icon:"fa-solid fa-spinner"}}):e._e(),e._v("\n    送出預約\n  ")],1):t("button",{staticClass:"fixed bottom-24 left-[5%] w-[90%] py-2.5 text-white text-lg rounded-md mt-10 duration-300 z-0",class:{"bg-[#232D4E]":!e.isLoading,"bg-[#bebebe] pointer-events-none":e.isLoading},on:{click:function(t){return e.handleNonDesignationBooking()}}},[e.isLoading?t("fa",{staticClass:"animate-spin",attrs:{icon:"fa-solid fa-spinner"}}):e._e(),e._v("\n    送出預約\n  ")],1)],1)}),[function(){var e=this,t=e._self._c;return t("ul",{staticClass:"mt-6"},[t("li",{staticClass:"px-2 pb-3 border-b border-b-[#aeaeae]"},[t("div",{staticClass:"flex justify-between"},[t("div",{staticClass:"col-span-10"},[t("p",{staticClass:"text-sm"},[e._v("服務/產品名稱")])]),e._v(" "),t("div",{staticClass:"col-span-2"},[t("p",{staticClass:"text-sm"},[e._v("售價")])])])])])}],!1,null,null,null);t.default=component.exports}}]);